今天我解决了一个问题.

这是一个复杂的事情.但是可以简单的讲.具体的事情不方便讲,但是我可以变种一下,编出一个故事.

故事是这样的.

我是一个侦探.姓下,下流的下.你们可以叫我下落课.学生们喜欢我,更喜欢听老师亲昵的喊我下课.
最近收到报案,校园女厕发生灵异事件.已经三名女学生被吓哭.
没有什么悬疑,问题很直白,是谁在装神弄鬼?

老王是厕所的清洁工.五十多岁,脑袋大大的,掺杂些花白.蓝色工作服干干净净,黄色手套,一个口罩. 
平日里并不多言语.一般孩子们上课的时候,他会进去打扫清理一下厕所.再其他时间,可以看见他在校
园里,打扫卫生.总之,你看见他的时候,他基本都在工作.

作为一名侦探,虽然是业界很失败的侦探,我知道,他虽默默无闻,但他是这个校园扫地僧,是孩子们的
守护者.真正的谜底,必然要从他身上揭开.

"我是小下.负责调查厕所灵异事件.您好,王师傅.." 我在开水房旁找到他.他正在拖地.
并没有抬头,也没有说话.
"王师傅.学校出了这种事,孩子们很恐慌.得早点找出真相."
他看了我一眼,继续拖地.我知道他在听.
"我需要你的帮助,每天下午五点到七点这两个小时内,麻烦你帮我盯一下稍.记录一下什么时间都有谁
进入女厕."
他露出些许疑惑的眼神,然后又很快低头拖地了.我静静站着,看他拖地.
就这样静静看他拖了两分钟地后,"早上九点,到门卫室自己来拿."说完,他就继续拖地,头也不抬,越拖越远.我知道没有需要再谈的了.道声谢离开.

"17:03分,陈静静进入厕所,一双运动鞋,蹦蹦跳跳,粗粗的小腿,圆圆的腰,还有黄色小裙子."
我在六年级语文教师办公室.一杯咖啡左前方冒着热气散着香味.一支2B铅笔右手自由翻转.看似闲暇
无聊的我,两眼直盯女厕.

我断定有人在五点到七点之间捣鬼. 这段时间是放学时间,孩子们来来往往,人多.七点过后,天就要黑
了.天黑之后,是他们上演好戏的时候. 但准备时期必然在这个时候. 我两眼通红,并未发现一丝异样.

在这盯梢中,我迷迷糊糊打起了盹.
8点十分. 一声尖叫. 我一个激灵.立马起身,咖啡已经凉了,但我动作太大,还是洒了少许到我白色衬
衫的袖口和那张木制书桌上.我立马蹬蹬瞪往女厕跑.

和我一起赶到的,还有在值班的小花老师.小花老师此时小脸通红,由于急速奔跑,胸口正在起伏.奶糖色牛仔裤勾勒出完美曲线,空气中一股沙宣清香,带着些许微妙的温度.我登时感觉鼻血有点热. 眼
神示意小花老师先进去. 我在门口,时刻准备冲进女厕.先后脑补了三个进场画面.不过,不到30秒,小花老师就扶着尖叫的学生,从厕所出来了. 孩子面色惨白,目光涣散,衣衫有些许凌乱.后背有靠在墙角
蹭的墙灰. 我没有说一句话. 目送小花老师带着孩子去往医务室. 我再次回到语文办公室. 没开灯,
点了根烟. 我看见女厕不远处,门房昏黄的灯亮着.

"晚上,门房的灯一直亮着..." 我自言自语到.

我盯着我的记录笔记,逐条脑中过滤. 真是头大,不该打盹. 可能错过了很重要的信息,我在自责中抓着头,不知不觉就在语文办公室趴了一夜. 早上醒来头发散乱,眼袋松弛,脸上污污的. 摇摇晃晃去水
房洗脸. 洗脸的时候,我看见老王在打扫水房. 扫完离开时,他意味深长的看了我一眼. 我突然想起他那句话
"早上九点,到门卫室自己来拿."

我看了看表,八点三十四. 去食堂巴拉早饭,带了份去门卫室.
进屋后,老王并不在,我看见桌上有个本子.打开的.散散乱乱记录了一些东西.我知道这是给我留的.
我留下了早餐,带走了老王的记录本.

老王的记录很奇怪.第一感觉是小学文化写的.里面有错别字,有拼音.关键还是方言.
其实后来我才知道,这些是密文. 老王之所以拿密文写,是因为他掌握了一些东西,但他还不能暴露,还
需要继续了解更多. 我的出现,可以替他打掩护,但是并不能把所有事情都告诉我.需要我来根据提示
找到答案. 这样于他有利. 谁也不会想到,门房老王早已看穿一切. 不过我当时并没有意识那么多.
只是简单的以为,他文化程度低.

我快速把他的天书翻译过来.
然后对比了一下,发现,老王和我记录的不同. 他会多记,也有漏记. 总之,他记录的和我记录的有出入.
那么我就要对这两份记录数据进行一下整理了. 找出我们共有的数据,找出他独有的,找出我独有的.
然后进一步找出可疑的数据.

精通计算机的我立马想到,我需要个diff~
精通数学的我立马想到,我需要来个集合的交叉并计算.
精通游戏的我立马想到,我需要玩一把找你妹.
精通编故事的我现在要告诉诸位,我们切入正题.
```
mao [{:k 2} {:k 3} {:k 4} {:k 5} {:k 6}]
mi [4 5 6 7 8]
```
我们有两个列表,一个是猫,一个是咪. 猫里的{:k 4} 和咪里的4是同一只喵星人.
问题来了哦,找出猫和咪共有的喵星人哦.
一言不合,我直接贴代码吧.
```
(println "寻找喵星人")
(defn doWeTheSame? [me you fm fy] 
    (= (fm me) (fy you)))

(defn diff [left right fl fr]
  (let 
    [both 
     (filter (comp not nil?) 
       (flatten 
         (map (fn [leftnode] 
               (map 
                 (fn [rightnode] 
                  (if (doWeTheSame? leftnode rightnode fl fr) {:leftnode leftnode :rightnode rightnode}))
                 right))
             left)))
    
     onlyleft '()
     onlyright '()] 
   {:both both :onlyleft onlyleft :onlyright onlyright}))  
        

(defn demo []
    (let [left [{:k 2} {:k 3} {:k 4} {:k 5} {:k 6}]
          right [4 5 6 7 8]
          fl :k
          fr identity]
        (diff left right fl fr)))

;Todo: onlyleft  onlyright
; user=> (pprint (demo))
; {:both
;  ({:leftnode {:k 4}, :rightnode 4}
;   {:leftnode {:k 5}, :rightnode 5}
;   {:leftnode {:k 6}, :rightnode 6}),
;  :onlyleft (),
;  :onlyright ()}
; nil

```
懵逼看不懂的,我有Java版本的.See At `http://github.com/blankrain/diff`

这里我想说说diff函数的本质.
diff函数的本质是 事物的相等性. Java里是equals方法. 我这里的是doWeTheSame? 函数.
顾名思义,我们一样吗?

补充一点,sort函数的本质是事物的偏序性. 啥是偏序性? 序数词大家都知道的吧. 第一第二第三.
偏序性就是,你可以排出个三六九的,就是偏序性.Java里就是`java.lang.Comparable` 接口

最后说说我的diff实现的思路.
我采用了笨办法. 就是一个一个比较. 一个一个比,优点是逻辑简单. 但存在一个问题,会重复比.不过这个可以优化. 
嗯~ 
下课.

